<!doctype html><html lang=en-us><head><title>Shmulik Klein | Blog</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content="This post discuss on seal classes feature and when to use it, including pattern matching"><link rel=stylesheet href=../../css/theme.min.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-1LHXLEKFK2"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-1LHXLEKFK2")}</script></head><body><div id=content class=mx-auto><header class="container mt-sm-5 mt-4 mb-4 mt-xs-1"><div class=row><div class="col-sm-4 col-12 text-sm-right text-center pt-sm-4"><a href=../../ class=text-decoration-none><img id=home-image class=rounded-circle src=../../logo.jpeg></a></div><div class="col-sm-8 col-12 text-sm-left text-center"><h2 class="m-0 mb-2 mt-4"><a href=../../ class=text-decoration-none>Shmulik Klein</a></h2><p class="text-muted mb-1">Software Engineer @ JetBrains | Munich, Germany</p><ul id=nav-links class="list-inline mb-2"><li class=list-inline-item><a class="badge badge-white" href=../../about title=About>About</a></li><li class=list-inline-item><a class="badge badge-white" href=../../posts/ title=Posts>Posts</a></li><li class=list-inline-item><a class="badge badge-white" href=../../tags/ title=Tags>Tags</a></li><li class=list-inline-item><a class="badge badge-white" href=../../categories/ title=Categories>Categories</a></li><li class=list-inline-item><a class="badge badge-white" href=../../series/ title=Series>Series</a></li></ul><ul id=nav-social class=list-inline><li class="list-inline-item mr-3"><a href=http://github.com/shmulik-klein target=_blank><i class="fab fa-github fa-1x text-muted"></i></a></li><li class="list-inline-item mr-3"><a href="https://www.linkedin.com/in/shmulik-klein/?lipi=urn%3Ali%3Apage%3Ad_flagship3_feed%3BuBzQ49WXS3K1iGjTur%2Fycw%3D%3D" target=_blank><i class="fab fa-linkedin-in fa-1x text-muted"></i></a></li><li class="list-inline-item mr-3"><a href=https://stackoverflow.com/users/2776473/shmulik-klein target=_blank><i class="fab fa-stack-overflow text-muted"></i></a></li><li class="list-inline-item mr-3"><a href=https://x.com/klein_sh target=_blank><i class="fab fa-x-twitter fa-1x text-muted"></i></a></li><li class="list-inline-item mr-3"><a href=mailto:shmulik-klein@gmail.com target=_blank><i class="fas fa-envelope fa-1x text-muted"></i></a></li></ul></div></div><hr></header><div class=container><div class="pl-sm-4 ml-sm-5"><h3 id=sealed-with-a-kiss>Sealed with a Kiss</h3><p>Java 15 introduced a preview feature called <a href=https://openjdk.org/jeps/360>Sealed Classes and Intefaces</a>, which was finalized in Java 17.
Sealed classes and interfaces restrict which other classes or interfaces may extend or implement them.</p><p>You seal a class/interface by applying the <code>sealed</code> modifier before the <code>class</code>/<code>interface</code> keyword. Than, you have to provide which classes/interface are allowed to inherit/implement the sealed class/interface using the <code>permits</code> keyword.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>sealed</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Sensor</span> permits TempSensor, ForceSensor, PiezoSensor {
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TempSensor</span> <span style=color:#66d9ef>extends</span> Sensor {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=to-seal-or-not-to-seal>To Seal or not to Seal?</h3><p>Is sealing a class/interface is really a necssary feature? what does its purpose?</p><blockquote><p>The purpose of sealing a class is to let client code reason clearly and conclusively about all permitted subclasses. <em>JEP-360: Sealed Classes</em></p></blockquote><p>The JEP states that before sealed classes, the only way the reason about an object sub-type, was to chain <code>instanceof</code> if-conditions. This old way required the code to have a catch-all <code>else</code> case, since the compiler couldn&rsquo;t know if all the subclasses were taken into account. If such a catch-all clause was missing, a compile time error would have been thrown. On the other hand such a clause is redundant, since the user knows which classes are subclasses of the superclasses, he just doesn&rsquo;t have a way to pass that for the compiler.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>react</span>(Sensor sensor) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (sensor <span style=color:#66d9ef>instanceof</span> TempSensor) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> ... <span style=color:#75715e>// do something with ((TempSensor) sensor)</span>
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (sensor <span style=color:#66d9ef>instanceof</span> ForceSensor) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> ... <span style=color:#75715e>// do something with ((ForceSensor) sensor)</span>
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (sensor <span style=color:#66d9ef>instanceof</span> PiezoSensor) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> ... <span style=color:#75715e>// do something with ((PiezoSensor) sensor)</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Compiler, are there any other subclasses that I need to take into accout here?</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>That&rsquo;s where <em>Pattern Matching</em> and <em>Test Patterns</em> fits in.</p><blockquote><p>Instead of inspecting an instance of a sealed class with if-else, client code will be able to switch over the instance using type test patterns (<a href=https://openjdk.org/jeps/375>JEP 375</a>). This allows the compiler to check that the patterns are <em>exhaustive</em>. <em>JEP-360: Sealed Classes</em></p></blockquote><p>No catch-all clause is required and the compiler can warn us if we missed a subclass of the sealed superclass.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>react</span>(Sensor sensor) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>switch</span> (shape) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> TempSensor t    <span style=color:#f92672>-&gt;</span> ... t.<span style=color:#a6e22e>getTemp</span>() ...
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> ForceSensor f <span style=color:#f92672>-&gt;</span> ... f.<span style=color:#a6e22e>getMass</span> ...
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> PiezoSensor p   <span style=color:#f92672>-&gt;</span> ... s.<span style=color:#a6e22e>getElectricCharge</span>() ...
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>A more compact and expressive code + no need for the explict subclass cast</p></div></div></div><footer class="text-center pb-1"><small class=text-muted>&copy; Copyright 2025, Shmulik Klein<br>Powered by <a href=https://gohugo.io/ target=_blank>Hugo</a>
and <a href=https://github.com/austingebauer/devise target=_blank>Devise</a></small></footer></body></html>